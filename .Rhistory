str(modFit2)
varImp(modFit$finalModel)
modFit$finalModel
str(modFit$finalModel)
str(modFit$finalModel$forest)
modFit$finalModel$forest$bestvar
modFit$finalModel$forest
modFit$finalModel
modFit
modFit$finalModel$forest
str(modFit$finalModel$forest)
modFit$finalModel$forest$treemap
str(modFit$finalModel$forest)
str(modFit)
modFit$results
modFit$modelInfo
str(modFit)
modFit$modelInfo$varImp
str(modFit$modelInfo)
modFit$results
library("devtools", lib.loc="~/R/win-library/3.0")
install_github('slidify', 'ramnathv')
detach("package:datasets", unload=TRUE)
detach("package:graphics", unload=TRUE)
detach("package:grDevices", unload=TRUE)
detach("package:methods", unload=TRUE)
detach("package:stats", unload=TRUE)
detach("package:utils", unload=TRUE)
library("utils", lib.loc="C:/Program Files/R/R-3.0.2/library")
library("stats", lib.loc="C:/Program Files/R/R-3.0.2/library")
library("methods", lib.loc="C:/Program Files/R/R-3.0.2/library")
library("datasets", lib.loc="C:/Program Files/R/R-3.0.2/library")
library("graphics", lib.loc="C:/Program Files/R/R-3.0.2/library")
?lm
?dgamma
?colSums
?predict
?showMethods()
?getMethods()
?getS3Method()
?getClass()
library("knitr", lib.loc="~/R/win-library/3.0")
library("stringr", lib.loc="~/R/win-library/3.0")
current <- getwd()
library(stringr)
MSOffice_exportTest <- read.csv("~/MSOffice_exportTest.csv", stringsAsFactors=FALSE)
View(MSOffice_exportTest)
returnFile <- returnFile[-1,]
rm(MSOffice_exportTest)
returnFile <- read.csv("~/MSOffice_exportTest.csv", stringsAsFactors=FALSE)
returnFile <- returnFile[-1,]
?gsub
trouble <- c(™", "©", "®")
trouble <- c("™", "©", "®")
str(returnFile)
newNames <- returnFile$i..NAme
newNames <- returnFile$i..Name
colnames(returnFile)[1]
returnFile$ï..Name
newNames <- returnFile$ï..Name
lapply(newNames, function(x) gsub(trouble[1],"",x))
sum(newNames != returnFile$ï..Name)
newNames <- lapply(newNames, function(x) gsub("™","",x))
sum(newNames != returnFile$ï..Name)
newNames["™" %in% newNames]
sum("™" %in% newNames)
sum("©" %in% newNames)
newNames[17290:17300]
newNames[3535:3540]
newNames[3435:3440]
newNames[3430:3440]
newNames[3330:3440]
newNames[3420:3440]
newNames[3420]
newNames[8767]
newNames <- lapply(newNames, function(x) gsub("â„¢","",x))
sum(newNames != returnFile$ï..Name)
newNames <- lapply(newNames, function(x) gsub("Â®","",x))
sum(newNames != returnFile$ï..Name)
newNames <- lapply(newNames, function(x) gsub("%","pct",x))
sum(newNames != returnFile$ï..Name)
library("Quandl", lib.loc="~/R/win-library/3.0")
Quandl("YAHOO/INDEX_GSPC", trim_start="1950-01-03", trim_end="2014-09-05",
authcode="3LpJ3vz9eqRsM7PFP2vw")
Quandl.limit()
sp5 <- Quandl("YAHOO/INDEX_GSPC", trim_start="1950-01-03", trim_end="2014-09-05",
authcode="3LpJ3vz9eqRsM7PFP2vw")
ls()
files_to_remove <- ls()
for (1 in 1:44){
if (files_to_remove[i] != "sp5" && files_to_remove[i] != "files_to_remove")
show(files_to_remove[i])
}
for (i in 1:44){
if (files_to_remove[i] != "sp5" && files_to_remove[i] != "files_to_remove")
show(files_to_remove[i])
}
for (i in 1:44){
if (files_to_remove[i] != "sp5" && files_to_remove[i] != "files_to_remove")
rm(files_to_remove[i])
}
files_to_remove <- ls()
objects_to_remove <- ls()
for (i in 1:46){
if (objects_to_remove[i] !(%in% c("sp5", "objects_to_remove"))){
show(objects_to_remove[i])
}
for (i in 1:46){
if (objects_to_remove[i] !(%in% c("sp5", "objects_to_remove"))){
show(objects_to_remove[i])
}
}
objects_to_keep <- c("sp", "objects_to_keep")
objects <- ls()
for (i in 1:48){
if (objects[i] %in% objects_to_keep){
next
} else {
show(objects[i])
}
}
objects <- ls()
objects_to_keep <- c("sp", "objects_to_keep")
objects_to_remove <- objects[!(objects %in% objects_to_keep)]
objects_to_remove <- objects[-(objects %in% objects_to_keep)]
for (i in 1:48){
nextObject <- objects_to_remove
if (nextObject %in% objects_to_keep){
next
} else {
show(paste("rm(", nextObject, sep = ""))
}
}
for (i in 1:48){
nextObject <- objects_to_remove
if (nextObject %in% objects_to_keep){
next
} else {
show(paste0("rm(", nextObject, ")" sep = ""))
}
}
for (i in 1:48){
nextObject <- objects_to_remove
if (nextObject %in% objects_to_keep){
next
} else {
show(paste0("rm(", nextObject, ")", sep = ""))
}
}
warnings()
for (i in 1:48){
nextObject <- objects_to_remove[i]
if (nextObject %in% objects_to_keep){
next
} else {
show(paste0("rm(", nextObject, ")", sep = ""))
}
}
?cat
for (i in 1:48){
nextObject <- objects_to_remove[i]
if (nextObject %in% objects_to_keep){
next
} else {
cat("rm(", nextObject, ")", sep = "")
}
}
?eval
for (i in 1:48){
nextObject <- objects_to_remove[i]
if (nextObject %in% objects_to_keep){
next
} else {
eval(cat("rm(", nextObject, ")", sep = ""))
}
}
ls()
library(reshape2)
library(plyr)
df <- read.csv("./data/beer_reviews.csv")
library(reshape2)
library(plyr)
df <- read.csv("./data/beer_reviews.csv")
head(df)
n <- 100
beer_counts <- table(df$beer_name)
beers <- names(beer_counts[beer_counts > n])
df <- df[df$beer_name %in% beers,]
ECOV <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)
View(ECOV)
covAC2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[3:11, 2:10]
covAC2010 == t(covAC2010)
port2010 <- diag(read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[18:24, 17:23])
port2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[18:24, 17:23]
sqrt(diag(port2010))
port2010 == t(port2010)
diag(port2010)
port2010 <- matrix(read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[18:24, 17:23])
port2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[18:24, 17:23]
colnames(port2010) <- c("Port1", "Port2", "Port3", "Port4", "Port5", "Port6", "Port7" )
?diag()
diag(port2010)
port2010 <- unlist(port2010)
port2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[18:24, 17:23]
colnames(port2010) <- c("Port1", "Port2", "Port3", "Port4", "Port5", "Port6", "Port7" )
port2010 <- as.matrix(unlist(port2010), nrow = 7, ncol = 7)
port2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[18:24, 17:23]
port2010 <- matrix(unlist(port2010), nrow = 7, ncol = 7)
colnames(port2010) <- c("Port1", "Port2", "Port3", "Port4", "Port5", "Port6", "Port7" )
diag(port2010)
sqrt(diag(port2010))
retAC2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[1, 2:10]
targets_exposures <- read.csv("~/InvCommittee/portfolio_monitoring_thresholds/targets_exposures.csv")
View(targets_exposures)
targets_exposures <- read.csv("~/InvCommittee/portfolio_monitoring_thresholds/targets_exposures.csv")
clients <- colnames(targets_exposures)[4:6]
targets_exposures[targets_exposures$Portfolio == 7, 3]/100.0
deviations <- targets_exposures[targets_exposures$Portfolio == 7, 4:6] - targets_exposures[targets_exposures$Portfolio == 7, 3]/100.0
show(deviations)
trackingError <- sqrt(t(deviations) %*% (covAC2010 %*% deviations) )
covAC2010 <- matrix(unlist(read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[3:11, 2:10]), nrow = 9, ncol = 9)
retAC2010 <- read.table("C:/userdata/ECOV.out", quote="\"", stringsAsFactors=FALSE)[1, 2:10]
trackingError <- sqrt(t(deviations) %*% (covAC2010 %*% deviations) )
deviations <- matrix(unlist(targets_exposures[targets_exposures$Portfolio == 7, 4:6] - targets_exposures[targets_exposures$Portfolio == 7, 3]/100.0), nrow = 7, ncol = 3)
show(deviations)
trackingError <- sqrt(t(deviations) %*% (covAC2010 %*% deviations) )
show(deviations)
targets_exposures
deviations <- matrix(unlist(targets_exposures[targets_exposures$Portfolio == 7, 4:6] - targets_exposures[targets_exposures$Portfolio == 7, 3]/100.0), nrow = 9, ncol = 3)
show(deviations)
trackingError <- sqrt(t(deviations) %*% (covAC2010 %*% deviations) )
show(deviations)
covAC2010 %*% deviations
t(deviations) %*% (covAC2010 %*% deviations)
trackingError <- sqrt(diag(t(deviations) %*% (covAC2010 %*% deviations) ))
names(trackingError) <- clients
show(trackingError)
show(deviations)
?show
library(scales)
percent(show(trackingError))
percent(trackingError))
percent(trackingError)
percent(deviations)
show(cbind(clients,percent(trackingError)))
teTable <- cbind(clients,percent(trackingError))
colnames(teTable)[2] <- "Tracking Error"
teTable
contributions <- covAC2010 %*% deviations
colnames(contributions) <- clients
rownames(contributions)
rownames(contributions) <- seq(1:9)
rownames(contributions)
contributions
percent(contributions)
apply(contributions, 2, percent)
contributions <- deviations * (covAC2010 %*% deviations)
colnames(contributions) <- clients
rownames(contributions) <- seq(1:9)
apply(contributions, 2, percent)
apply(deviations, 2, percent)
colnames(deviations) <- clients
apply(deviations, 2, percent)
targets_exposures
targets_exposures[1:9,1:3]
deviations <- matrix(unlist(targets_exposures[1:9, 4:6] - targets_exposures[1:9, 3]/100.0), nrow = 9, ncol = 3)
deviations
targets_exposures[1:9, 3]/100.0
targets_exposures <- read.csv("~/InvCommittee/portfolio_monitoring_thresholds/targets_exposures.csv")[1:9,]
order(target_exposures[,2])
order(target_exposures[,2])
order(target_exposures[,2])
order(targets_exposures[,2])
targets_exposures <- targets_exposures[order(targets_exposures[,2]), ]
clients <- colnames(targets_exposures)[4:6]
deviations <- matrix(unlist(targets_exposures[, 4:6] - targets_exposures[, 3]/100.0), nrow = 9, ncol = 3)
trackingError <- sqrt(diag(t(deviations) %*% (covAC2010 %*% deviations) ))
names(trackingError) <- clients
teTable <- cbind(clients,percent(trackingError))
colnames(teTable)[2] <- "Tracking Error"
teTable
contributions <- deviations * (covAC2010 %*% deviations)
colnames(contributions) <- clients
rownames(contributions) <- seq(1:9)
apply(contributions, 2, percent)
colnames(deviations) <- clients
apply(deviations, 2, percent)
library("dplyr", lib.loc="~/R/win-library/3.0")
location(iris)
iris2 <- iris
location(iris2)
changes(iris2, iris)
iris2$Sepal.Length <- iris2$Sepal.Length * 2
changes(iris, iris2)
iris3 <- mutate(iris, Sepal.Length = Sepal.Length * 2)
changes(iris3, iris)
summarise(per_day, flights = sum(flights))
library(hflights)
str(hflights)
library(Lahman)
batting <- select(tbl_df(Batting), playerID, yearID, teamID, G, AB:H)
batting <- arrange(batting, playerID, yearID, teamID)
players <- group_by(batting, playerID)
filter(players, min_rank(desc(H)) <= 2 & H > 0)
mutate(players, G_rank = min_rank(G))
filter(players, G > lag(G))
mutate(players, G_change = (G - lag(G)) / (yearID - lag(yearID)))
filter(players, G > mean(G))
mutate(players, G_z = (G - mean(G)) / sd(G))
install.packages("stockReturns")
install.packages("stockPortfolio")
library("stockPortfolio", lib.loc="~/R/win-library/3.0")
getReturns("ticker"^GSPC", freq = c("month", "week", "day"),
get = c("overlapOnly", "all"), start = "1950-01-01", end = NULL)
getReturns("ticker"^GSPC", freq = "month",
getReturns("^GSPC", freq = "month",
get = c("overlapOnly", "all"), start = "1950-01-01", end = NULL)
getReturns("^GSPC", freq = "month",
get = c("overlapOnly", "all"), start = "1970-01-01", end = NULL)
getReturns("GLD", freq = "month",
get = c("overlapOnly", "all"), start = "2014-03-31", end = NULL)
getReturns("GLD", freq = "month",
get = "overlapOnly", start = "2014-03-31", end = NULL)
get = "all", start = "2014-03-31", end = NULL)
getReturns("GLD", freq = "month",
get = "all", start = "2014-03-31", end = NULL)
getReturns("GLD", freq = "month",
get = "all", start = "2014-03-31", end = "NULL"2014-08-31)
get = "all", start = "2014-03-31", end = "2014-08-31")
getReturns("GLD", freq = "month",
get = "all", start = "2014-03-31", end = "2014-08-31")
stock94Info
data(stock94Info)
head(stock94Info)
stock94Info
library(zoo)
library(tseries)
install.packages("tseries")
library(tseries)
spComp <- read.csv("raw_data/sp500_constituents.csv" )
spComp <- read.csv("https://www.dropbox.com/s/vei2cbxy0kfulqv/sp500_constituents.csv" )
detach("package:stockPortfolio", unload=TRUE)
hflights_df <- tbl_df(hflights)
hflights_df
filter(hflights_df, Month == 1, DayofMonth == 1)
summarise(hflights_df,
delay = mean(DepDelay, na.rm = TRUE))
library(nycflights)
library(hflights13)
library(nycflights13)
install.packages("nycflights13")
library("devtools", lib.loc="~/R/win-library/3.0")
install_github(nycflights13)
install_github("nycflights13")
install.packages("nleqslv")
library("nleqslv", lib.loc="~/R/win-library/3.0")
library(nleqslv)
T <- 1
D1 <- 1000
R <- 0.01
sigmaS <- .1
SO1 <- 1000
fnewton <- function(x){
y <- numeric(2)
d1 <- (log(x[1]/D1)+(R+x[2]^2/2)*T)/x[2]*sqrt(T)
d2 <- d1-x[2]*sqrt(T)
y[1] <- SO1 - (x[1]*pnorm(d1) - exp(-R*T)*D1*pnorm(d2))
y[2] <- sigmaS*SO1 - pnorm(d1)*x[2]*x[1]
y
}
xstart <- c(21623379, 0.526177094846878)
nleqslv(xstart, fnewton, control=list(btol=.01), method="Newton")
assets <- c("Treasuries",
"TIPS",
"Corp. Bonds",
"US Stocks",
"Int'l Stocks",
"Commodities")
volatilities <- c(0.07, 0.1, 0.12, 0.2, 0.2, 0.3)
correlations <- matrix(cbind(c(1.00,0.95,0.60,0.10,0.10,0.10),
c(0.95,1.00,0.65,0.10,0.10,0.10),
c(0.60,0.65,1.00,0.35,0.35,0.20),
c(0.10,0.10,0.35,1.00,0.70,0.10),
c(0.10,0.10,0.35,0.70,1.00,0.15),
c(0.10,0.10,0.20,0.10,0.15,1.00)), nrow = 6,
ncol = 6)
covariances <- correlations * (volatilities %*% t(volatilities))
weights <- c(.3026, .2085, .1570, .1184, .1156, .0979)
wcov <- covariances %*% weights
portVar <- (t(weights) %*% wcov)[1,1]
portSD <- sqrt(portVar)
betas <- wcov / portVar
dslnex <- function(x) {
y <- numeric(2)
y[1] <- x[1]^2 + x[2]^2 - 2
y[2] <- exp(x[1]-1) + x[2]^3 - 2
y
}
jacdsln <- function(x) {
n <- length(x)
Df <- matrix(numeric(n*n),n,n)
Df[1,1] <- 2*x[1]
Df[1,2] <- 2*x[2]
Df[2,1] <- exp(x[1]-1)
Df[2,2] <- 3*x[2]^2
Df
}
BADjacdsln <- function(x) {
n <- length(x)
Df <- matrix(numeric(n*n),n,n)
Df[1,1] <- 4*x[1]
Df[1,2] <- 2*x[2]
Df[2,1] <- exp(x[1]-1)
Df[2,2] <- 5*x[2]^2
Df
}
xstart <- c(2,0.5)
fstart <- dslnex(xstart)
xstart
fstart
nleqslv(xstart, dslnex, control=list(btol=.01))
nleqslv(xstart, dslnex, control=list(trace=1,btol=.01,delta=-1.0))
nleqslv(xstart, dslnex, control=list(trace=1,btol=.01,delta=-2.0))
z <- nleqslv(xstart, dslnex, jacobian=TRUE,control=list(btol=.01))
z$x
z$jac
jacdsln(z$x)
xstart <- c(0.5,2)
z <- nleqslv(xstart, dslnex, jacobian=TRUE,control=list(btol=.01))
z$x
z$jac
jacdsln(z$x)
install.packages("devtools")
setwd("~/GitHub/portfolioRiskVis")
shiny::runApp()
shiny::runApp()
barplot(contributions)
barplot(contributions, legend = AC)
barplot(contributions, legend = targets_exposure$AC)
barplot(contributions, legend = targets_exposures$AC)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
solve(covariances, Expected_Return)
Asset <- c("Commodities","Int'l Stocks","US Stocks","Corp. Bonds","TIPS","Treasuries"
)
Volatility <- c(0.3, .2, .2, .12, .1, .07)
Expected_Return <- c(0.05, .07, .08, .03, .01, .02)
volDF <- data.frame(cbind(Volatility, Expected_Return))
rownames(volDF) <- Asset
correlations <- matrix(cbind(c(1, 0.15, 0.1, 0.2, 0.1, 0.1),
c(0.15, 1, 0.7, 0.35, 0.1, 0.1),
c(0.1, 0.7, 1, 0.35, 0.1, 0.1),
c(0.2, 0.35, 0.35, 1, 0.65, 0.6),
c(0.1, 0.1, 0.1, 0.65, 1, 0.95),
c(0.1, 0.1, 0.1, 0.6, 0.95, 1)), nrow = 6)
colnames(correlations) <- Asset
rownames(correlations) <- Asset
covariances <- correlations * (Volatility %*% t(Volatility))
solve(covariances, Expected_Return)
solve(covariances, Expected_Return)/sum(solve(covariances, Expected_Return))
?inverse
solve(covariances)
solve(covariances)*rep(1, 6)
solve(covariances)%*%rep(1, 6)
minVar <- solve(covariances)%*%rep(1, 6)/sum(solve(covariances)%*%rep(1, 6))
maxSharpe <- solve(covariances, Expected_Return)/sum(solve(covariances, Expected_Return))[,1]
maxSharpe <- (solve(covariances, Expected_Return)/sum(solve(covariances, Expected_Return)))[,1]
maxSharpe <- solve(covariances, Expected_Return)/sum(solve(covariances, Expected_Return))
minVar <- solve(covariances)%*%rep(1, 6)[,1]/sum(solve(covariances)%*%rep(1, 6))
minVar <- (solve(covariances)%*%rep(1, 6))[,1]/sum(solve(covariances)%*%rep(1, 6))
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
maxSharpe
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
